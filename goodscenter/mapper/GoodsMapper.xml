<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.zm.goods.bussiness.dao.GoodsMapper">


	<resultMap type="com.zm.goods.pojo.po.Goods" id="goodsItem">
		<id column="id" property="id" jdbcType="INTEGER" />
		<result column="goods_id" property="goodsId" jdbcType="VARCHAR" />
		<result column="goods_name" property="goodsName" jdbcType="VARCHAR" />
		<result column="type" property="type" jdbcType="INTEGER" />
		<result column="brand_id" property="brandId" jdbcType="INTEGER" />
		<result column="brand" property="brandName" jdbcType="VARCHAR" />
		<result column="origin" property="origin" jdbcType="VARCHAR" />
		<result column="subtitle" property="subtitle" jdbcType="VARCHAR" />
		<result column="detail_path" property="detailPath" jdbcType="VARCHAR" />
		<result column="description" property="description" jdbcType="VARCHAR" />
		<result column="third_category" property="thirdCategory" jdbcType="VARCHAR" />
		<result column="second_category" property="secondCategory" jdbcType="VARCHAR" />
		<result column="first_category" property="firstCategory" jdbcType="VARCHAR" />
		<result column="create_time" property="createTime" jdbcType="VARCHAR" />
		<result column="update_time" property="updateTime" jdbcType="VARCHAR" />
		<result column="opt" property="opt" jdbcType="VARCHAR" />
		<result column="access_path" property="accessPath" jdbcType="VARCHAR" />
		<collection property="goodsFileList" ofType="com.zm.goods.pojo.GoodsFile">
			<id column="file_id" property="id" jdbcType="INTEGER" />
			<result column="goods_id" property="goodsId" jdbcType="VARCHAR" />
			<result column="path" property="path" jdbcType="VARCHAR" />
		</collection>
	</resultMap>
	
	<resultMap type="com.zm.goods.pojo.GoodsFile" id="goodsFile">
		<id column="id" property="id" jdbcType="INTEGER" />
		<result column="goods_id" property="goodsId" jdbcType="VARCHAR" />
		<result column="path" property="path" jdbcType="VARCHAR" />
		<result column="suffix" property="suffix" jdbcType="VARCHAR" />
		<result column="storeType" property="storeType" jdbcType="INTEGER" />
		<result column="type" property="type" jdbcType="INTEGER" />
		<result column="create_time" property="createTime" jdbcType="VARCHAR" />
		<result column="update_time" property="updateTime" jdbcType="VARCHAR" />
		<result column="opt" property="opt" jdbcType="VARCHAR" />
	</resultMap>
	
	<resultMap type="com.zm.goods.pojo.po.Items" id="items">
		<id column="id" property="id" jdbcType="INTEGER" />
		<result column="specs_tp_id" property="specsTpId" jdbcType="VARCHAR" />
		<result column="item_id" property="itemId" jdbcType="VARCHAR" />
		<result column="supplier_id" property="supplierId" jdbcType="INTEGER" />
		<result column="supplier_name" property="supplierName" jdbcType="VARCHAR" />
		<result column="status" property="status" jdbcType="INTEGER" />
		<result column="item_code" property="itemCode" jdbcType="VARCHAR" />
		<result column="sku" property="sku" jdbcType="VARCHAR" />
		<result column="reason" property="reason" jdbcType="VARCHAR" />
		<result column="unit" property="unit" jdbcType="VARCHAR" />
		<result column="shelf_life" property="shelfLife" jdbcType="VARCHAR" />
		<result column="create_time" property="createTime" jdbcType="VARCHAR" />
		<result column="update_time" property="updateTime" jdbcType="VARCHAR" />
		<result column="opt" property="opt" jdbcType="VARCHAR" />
		<result column="remark" property="remark" jdbcType="VARCHAR" />
		<result column="internal_price" property="internalPrice" jdbcType="NUMERIC" />
	</resultMap>

	<resultMap type="com.zm.goods.pojo.po.GoodsSpecs" id="goodsSpecs">
		<id column="id" property="id" jdbcType="INTEGER" />
		<result column="specs_id" property="specsId" jdbcType="VARCHAR" />
		<result column="encode" property="encode" jdbcType="VARCHAR" />
		<result column="conversion" property="conversion" jdbcType="INTEGER" />
		<result column="unit" property="unit" jdbcType="VARCHAR" />
		<result column="description" property="description" jdbcType="VARCHAR" />
		<result column="weight" property="weight" jdbcType="INTEGER" />
		<result column="info" property="info" jdbcType="VARCHAR" />
		<result column="carton" property="carton" jdbcType="VARCHAR" />
		<result column="create_time" property="createTime" jdbcType="VARCHAR" />
		<result column="update_time" property="updateTime" jdbcType="VARCHAR" />
		<result column="opt" property="opt" jdbcType="VARCHAR" />
	</resultMap>
	
	<resultMap type="com.zm.goods.pojo.po.GoodsSpecsTradePattern" id="goodsSpecsTp">
		<id column="id" property="id" jdbcType="INTEGER" />
		<result column="specs_id" property="specsId" jdbcType="VARCHAR" />
		<result column="goods_id" property="goodsId" jdbcType="VARCHAR" />
		<result column="specs_tp_id" property="specsTpId" jdbcType="VARCHAR" />
		<result column="status" property="status" jdbcType="INTEGER" />
		<result column="is_free_post" property="freePost" jdbcType="INTEGER" />
		<result column="is_free_tax" property="freeTax" jdbcType="INTEGER" />
		<result column="tag_ratio" property="tagRatio" jdbcType="INTEGER" />
		<result column="increment_tax" property="incrementTax" jdbcType="NUMERIC" />
		<result column="tariff" property="tariff" jdbcType="NUMERIC" />
		<result column="excise_tax" property="exciseTax" jdbcType="NUMERIC" />
		<result column="is_promotion" property="promotion" jdbcType="INTEGER" />
		<result column="discount" property="discount" jdbcType="NUMERIC" />
		<result column="is_welfare" property="welfare" jdbcType="INTEGER" />
		<result column="is_distribution" property="distribution" jdbcType="INTEGER" />
		<result column="is_combinedgoods" property="combinedgoods" jdbcType="INTEGER" />
		<result column="combined_specs_tp_id" property="combinedSpecsTpId" jdbcType="VARCHAR" />
		<result column="distribution_price" property="distributionPrice" jdbcType="NUMERIC" />
		<result column="display" property="display" jdbcType="INTEGER" />
		<result column="retail_price" property="retailPrice" jdbcType="NUMERIC" />
		<result column="vip_price" property="vipPrice" jdbcType="NUMERIC" />
		<result column="line_price" property="linePrice" jdbcType="NUMERIC" />
		<result column="instant_ratio" property="instantRatio" jdbcType="NUMERIC" />
		<result column="sale_num" property="saleNum" jdbcType="INTEGER" />
		<result column="item_id" property="itemId" jdbcType="VARCHAR" />
		<result column="is_fresh" property="fresh" jdbcType="INTEGER" />
		<result column="upshelf_time" property="upshelfTime" jdbcType="VARCHAR" />
		<result column="create_time" property="createTime" jdbcType="VARCHAR" />
		<result column="update_time" property="updateTime" jdbcType="VARCHAR" />
		<result column="opt" property="opt" jdbcType="VARCHAR" />
	</resultMap>

	<resultMap type="com.zm.goods.pojo.po.GoodsPricePO" id="goodsPrice">
		<id column="id" property="id" jdbcType="INTEGER" />
		<result column="item_id" property="itemId" jdbcType="VARCHAR" />
		<result column="specs_tp_id" property="specsTpId" jdbcType="VARCHAR" />
		<result column="min" property="min" jdbcType="INTEGER" />
		<result column="max" property="max" jdbcType="INTEGER" />
		<result column="cost_price" property="costPrice" jdbcType="NUMERIC" />
		<result column="internal_price" property="internalPrice" jdbcType="NUMERIC" />
		<result column="create_time" property="createTime" jdbcType="VARCHAR" />
		<result column="update_time" property="updateTime" jdbcType="VARCHAR" />
		<result column="opt" property="opt" jdbcType="VARCHAR" />
	</resultMap>
	
	<resultMap type="com.zm.goods.pojo.vo.GoodsIndustryModel" id="goodsIndustry">
		<id column="id" property="firstId" jdbcType="INTEGER" />
		<result column="first_id" property="id" jdbcType="VARCHAR" />
		<result column="industryName" property="industryName" jdbcType="VARCHAR" />
		<result column="tag_path" property="tagPath" jdbcType="VARCHAR" />
		<collection ofType="com.zm.goods.pojo.vo.GoodsCategoryModel" property="dictList">
			<id column="dictid" property="secondId" jdbcType="INTEGER" />
			<result column="second_id" property="id" jdbcType="VARCHAR" />
			<result column="dictName" property="dictName" jdbcType="VARCHAR" />
			<collection property="entryList" ofType = "com.zm.goods.pojo.vo.GoodsCategoryEnteryModel">
				<id column="entryId" property="thirdId" jdbcType="INTEGER" />
				<result column="third_id" property="id" jdbcType="VARCHAR" />
				<result column="entryName" property="entryName" jdbcType="VARCHAR" />
				<result column="is_popular" property="popular" jdbcType="INTEGER" />
				<result column="ttag_path" property="thirdPicPath" jdbcType="VARCHAR" />
			</collection>
		</collection>
	</resultMap>
	
	<resultMap type="com.zm.goods.processWarehouse.model.WarehouseModel" id="stockModel">
		<id column="id" property="id" jdbcType="INTEGER" />
		<result column="item_id" property="itemId" jdbcType="VARCHAR" />
		<result column="specs_tp_id" property="specsTpId" jdbcType="VARCHAR" />
		<result column="fxqty" property="fxqty" jdbcType="INTEGER" />
		<result column="frozenqty" property="frozenqty" jdbcType="INTEGER" />
		<result column="lockedqty" property="lockedqty" jdbcType="INTEGER" />
	</resultMap>
	
	<resultMap type="com.zm.goods.pojo.GoodsConvert" id="convert">
		<result column="item_id" property="itemId"/>
		<result column="sku" property="sku"/>
		<result column="conversion" property="conversion"/>
		<result column="carton" property="carton"/>
	</resultMap>
	
	<select id="listGoodsPriceByItemIds" parameterType="Object" resultMap = "goodsPrice">
		select * from kj_goods_price where item_id in
		<foreach collection="list" open="(" close=")" item="item" separator=",">
			#{item}
		</foreach>
	</select>
	
	<select id="listGoodsPriceBySpecsTpIds" parameterType="Object" resultMap = "goodsPrice">
		select gp.*,gi.specs_tp_id from kj_goods_item gi 
		left join kj_goods_price gp on gi.item_id = gp.item_id 
		where gi.status = 2 and gi.specs_tp_id in
		<foreach collection="list" open="(" close=")" item="item" separator=",">
			#{item}
		</foreach>
	</select>
	
	<select id = "queryGoodsCategory" parameterType="Object" resultMap = "goodsIndustry">
		select gfc.id,gfc.first_id,gfc.name as industryName,gfc.tag_path,gsc.id as dictid,gsc.second_id,gsc.name as dictName,
		gtc.id as entryId,gtc.name as entryName,gtc.third_id,gtc.is_popular,gtc.tag_path as ttag_path    
		from goods_first_category gfc left join goods_second_category gsc on gfc.first_id = gsc.first_id 
		left join goods_third_category gtc on gsc.second_id = gtc.second_id 
		where gfc.status = 1 and gsc.status =1 and gtc.status =1 order by gfc.sort ,gsc.sort ,gtc.sort
	</select>

	
	<select id="getGoodsByGoodsId" parameterType="Object" resultMap="goodsItem">
		select g.id,g.goods_id,g.goods_name, g.description,g.detail_path,g.subtitle,
		g.type,g.third_category,g.first_category,g.second_category,g.access_path,g.origin,
		gf.id as file_id,gf.path,gcb.brand
		from kj_goods g 
		left join goods_file gf on g.goods_id = gf.goods_id 
		left join goods_category_brand gcb on g.brand_id = gcb.brand_id
		where g.is_del = 0 and gf.type = 0 and g.goods_id = #{goodsId}
	</select>
	
	<select id="listGoodsSpecsTpByGoodsId" parameterType="Object" resultMap="goodsSpecsTp">
		select id,specs_tp_id,specs_id,goods_id,status,is_free_post,is_free_tax,tag_ratio,increment_tax,
		tariff,excise_tax,is_promotion,discount,is_distribution,is_welfare,is_combinedgoods,combined_specs_tp_id,
		display,distribution_price,vip_price,retail_price,line_price,instant_ratio,sale_num,item_id,is_fresh,
		upshelf_time from kj_goods_specs_tradepattern where is_del = 0 and goods_id = #{goodsId}
	</select>
	
	<select id="getGoodsSpecsTpBySpecsTpId" parameterType="Object" resultMap="goodsSpecsTp">
		select * from kj_goods_specs_tradepattern where specs_tp_id = #{specsTpId}
	</select>
	
	<select id="listGoodsSpecsBySpecsIds" parameterType="Object" resultMap="goodsSpecs">
		select id,weight,specs_id,encode,description,unit,info,carton,conversion from kj_specs_goods 
		where is_del = 0 and specs_id in
		<foreach collection="list" item="item" open="(" close=")"
			separator=",">
			#{item,jdbcType = VARCHAR}
		</foreach>
	</select>
	
	<select id="getGoodsSpecsBySpecsId" parameterType="Object" resultMap="goodsSpecs">
		select * from kj_specs_goods where specs_id = #{specsId}
	</select>

	<select id="listGoodsFile" parameterType="Object" resultMap="goodsFile">
		select * from goods_file where type = #{type, jdbcType = INTEGER}
		and
		goods_id in
		<foreach collection="list" item="item" open="(" close=")"
			separator=",">
			#{item,jdbcType = VARCHAR}
		</foreach>
		order by id asc
	</select>
	
	<select id="listItemsByItemIds" parameterType="Object" resultMap="items">
		select * from kj_goods_item where item_id in 
		<foreach collection="list" item="item" open="(" close=")" separator=",">
			#{item}
		</foreach>
	</select>
	
	<select id="getItemsByItemIds" parameterType="Object" resultMap="items">
		select * from kj_goods_item where item_id = #{itemId} 
	</select>
	
	<select id="listItemsBySpecsTpIds" parameterType="Object" resultMap="items">
		select i.*,p.internal_price from kj_goods_item i 
		left join kj_goods_price p on i.item_id = p.item_id
		where i.specs_tp_id in 
		<foreach collection="list" item="item" open="(" close=")" separator=",">
			#{item}
		</foreach>
	</select>
	
	<select id="getGoodsSpecsTpByParam" parameterType="Object" resultMap="goodsSpecsTp">
		select gtp.* from kj_goods_specs_tradepattern gtp 
		where gtp.status = 2 and gtp.specs_tp_id in 
		<foreach collection="list" item="item" open="(" close=")" separator=",">
			#{item}
		</foreach>
		<if test="isFx == 'fx'">
			and gtp.is_distribution = 1
		</if>
	</select>
	
	<select id="listGoodsSpecsTpBySpecsTpIds" parameterType="Object"
		resultMap="goodsSpecsTp">
		select id,specs_tp_id,specs_id,goods_id,status,is_free_post,is_free_tax,tag_ratio,increment_tax,
		tariff,excise_tax,is_promotion,discount,is_distribution,is_welfare,is_combinedgoods,combined_specs_tp_id,
		display,distribution_price,vip_price,retail_price,line_price,instant_ratio,sale_num,item_id,is_fresh,
		upshelf_time from kj_goods_specs_tradepattern where is_del = 0 and specs_tp_id in
		<foreach collection="list" item="item" open="(" close=")"
			separator=",">
			#{item,jdbcType = VARCHAR}
		</foreach>
	</select>
	
	<!-- 上架操作 -->
	<resultMap type="com.zm.goods.pojo.dto.GoodsSearch" id="goods4Lucene">
		<id column="specs_tp_id" property="specsTpId" jdbcType="VARCHAR" />
		<result column="goods_name" property="goodsName" jdbcType="VARCHAR" />
		<result column="retail_price" property="price" jdbcType="NUMERIC" />
		<result column="upshelf_time" property="upshelfTime" jdbcType="VARCHAR" />
		<result column="first_category" property="firstCategory" jdbcType="VARCHAR" />
		<result column="second_category" property="secondCategory" jdbcType="VARCHAR" />
		<result column="third_category" property="thirdCategory" jdbcType="VARCHAR" />
		<result column="is_welfare" property="welfare" jdbcType="INTEGER" />
		<result column="tag_ratio" property="ratio" jdbcType="INTEGER" />
		<result column="sale_num" property="saleNum" jdbcType="INTEGER" />
		<collection property="guideList" ofType="com.zm.goods.pojo.dto.GuideProperty">
			<id column="id" property="id" jdbcType="INTEGER" />
			<result column="name" property="name" jdbcType="VARCHAR" />
			<result column="val" property="value" jdbcType="VARCHAR" />
		</collection>
	</resultMap>
	
	<update id="updateTradeSpecsUpshelf" parameterType="Object">
		update kj_goods_specs_tradepattern set status = 2,is_distribution = 1,is_welfare=1,display=#{display},
		upshelf_time = now() where specs_tp_id in 
		<foreach collection="list" open="(" close=")" separator="," item="item">
			#{item}
		</foreach>
	</update>
	
	<update id="updateSignalKjGoodsUpShelves" parameterType="Object">
		update kj_goods_specs_tradepattern set status = 2,is_distribution = 1,is_welfare=1,display=#{display},
		upshelf_time = now(),item_id = #{bo.itemId}  
		where specs_tp_id = #{bo.specsTpId}
	</update>
	
	<update id="updateBatchKjGoodsUpShelves" parameterType="Object">
		<foreach collection="list" item="item" index="index" open=""
			close="" separator=";" >
			update kj_goods_specs_tradepattern set status = 2,is_distribution = 1,is_welfare=1,display=#{display},
			upshelf_time = now(),item_id = #{item.itemId} where specs_tp_id = #{item.specsTpId}
		</foreach>
	</update>
	
	<!-- 下架操作 -->
	<update id="updateSpecsTpDownShelves" parameterType="Object">
		update kj_goods_specs_tradepattern set status = 1,is_distribution = 0,display = 0,is_welfare=0,
		downshelf_time = now(),item_id = null where specs_tp_id in 
		<foreach collection="list" open="(" close=")" separator="," item="item">
			#{item}
		</foreach>
	</update>
	
	<select id="listSpecsNeedToCreateIndex" parameterType="Object" resultMap = "goods4Lucene">
		select g.first_category,g.second_category,g.third_category,g.goods_name,gtp.specs_tp_id,gtp.retail_price,
		gtp.upshelf_time,gtp.is_welfare,gtp.tag_ratio,gtp.sale_num,pn.name,pv.val 
		from kj_goods g 
		left join kj_goods_specs_tradepattern gtp on g.goods_id = gtp.goods_id
		left join kj_specs_goods ksg on gtp.specs_id = ksg.specs_id
		left join kj_goods_guide_property_bind kgpb on gtp.specs_tp_id = kgpb.specs_tp_id
		left join kj_guide_property_value pv on kgpb.property_val_id = pv.id
		left join kj_guide_property_name pn on kgpb.property_id = pn.id 
		where gtp.specs_tp_id in 
		<foreach collection="list" open="(" close=")" separator="," item="item">
			#{item}
		</foreach>
	</select>
	
	<!-- 前端搜索界面相关sql -->
	<select id="listGoodsSpecsTpForFrontSearch" parameterType="Object" resultMap="goodsSpecsTp">
		select id,specs_tp_id,specs_id,goods_id,status,is_free_post,is_free_tax,tag_ratio,increment_tax,
		tariff,excise_tax,is_promotion,discount,is_distribution,is_welfare,is_combinedgoods,combined_specs_tp_id,
		display,distribution_price,vip_price,retail_price,line_price,instant_ratio,sale_num,item_id,is_fresh,
		upshelf_time from kj_goods_specs_tradepattern where is_del = 0 
		<if test="isWelfare != null">
			and is_welfare = #{isWelfare} 
		</if>
		and specs_tp_id in 
		<foreach item="id" index="index" collection="list" open="("
			separator="," close=")">
			#{id}
		</foreach>
		<if test="sortList != null and sortList.size > 0">
		order by 
			<foreach item="sort" index="index" collection="sortList" open=""
				separator="," close="">
				${sort.sortField} ${sort.sortRule} 
			</foreach>
			, id desc
		</if>
		<if test="sortList == null or sortList.size == 0">
			order by tag_ratio desc, id desc
		</if>
	</select>
	
	<select id="listGoodsItemByGoodsIds" parameterType="Object" resultMap = "goodsItem">
		select g.id,g.goods_id,g.goods_name, g.description,g.detail_path,g.subtitle,
		g.type,g.third_category,g.first_category,g.second_category,g.access_path,g.origin,
		gf.id as file_id,gf.path,gcb.brand
		from kj_goods g 
		left join goods_file gf on g.goods_id = gf.goods_id 
		left join goods_category_brand gcb on g.brand_id = gcb.brand_id
		where g.is_del = 0 and gf.type = 0 and g.goods_id in 
		<foreach item="id" index="index" collection="list" open="("
			separator="," close=")">
			#{id}
		</foreach>
	</select>
	
	<!-- end -->
	
	<select id="listWarehouse" parameterType="Object" resultMap = "stockModel">
		select gs.*,gi.specs_tp_id from goods_stock gs left join kj_goods_item gi on gs.item_id = gi.item_id 
		where gs.item_id in
		<foreach item="item" index="index" collection="list" open="("
				separator="," close=")">
				#{item}
		</foreach>
	</select>
	
	<select id="listWarehouseBySpecsTpIds" parameterType="Object" resultMap = "stockModel">
		select sum(fxqty),gi.specs_tp_id from goods_stock gs left join kj_goods_item gi on gs.item_id = gi.item_id 
		where gi.specs_tp_id in
		<foreach item="item" index="index" collection="list" open="("
				separator="," close=")">
				#{item}
		</foreach>
	</select>
	
	<update id="updateStock" parameterType="Object">
		<foreach collection="list" item="item" index="index" open=""
			close="" separator=";" >
			update goods_stock
			<set>
				fxqty = fxqty - #{item.frozenqty},
				frozenqty = frozenqty + #{item.frozenqty}, update_time=now()
			</set>
			where item_id = #{item.itemId, jdbcType=VARCHAR}
		</foreach>
	</update>
	
	<update id="updateStockBack" parameterType="Object">
		<foreach collection="list" item="item" index="index" open=""
			close="" separator=";">
			update goods_stock
			<set>
				fxqty = ifnull(fxqty,0) + #{item.quantity},
				frozenqty = ifnull(frozenqty,0) - #{item.quantity}, update_time=now()
			</set>
			where item_id = #{item.itemId}
		</foreach>
	</update>
	
	<select id="getGoodsIdBySpecsTpId" parameterType="Object" resultType="java.lang.String">
		select goods_id from kj_goods_specs_tradepattern
		where specs_tp_id = #{specsTpId} 
	</select>
	
	<update id="updateThirdWarehouseStock" parameterType="Object">
		<foreach collection="list" item="item" index="index" open=""
			close="" separator=";">
			insert into goods_stock (item_id,qpqty,fxqty) values (#{item.itemId},#{item.quantity},#{item.quantity})
			ON DUPLICATE KEY UPDATE 
			qpqty = #{item.quantity},fxqty = #{item.quantity}, update_time=now()
		</foreach>
	</update>
	
	<insert id="saveThirdGoods" parameterType="Object">
		INSERT IGNORE INTO
		third_goods
		(supplier_id,supplier_name,sku,item_code,goods_name,brand,weight,origin,stock,min,max,status,create_time)
		VALUES
		<foreach collection="list" item="item" separator=",">
			(#{item.supplierId},#{item.supplierName},#{item.sku},#{item.itemCode},#{item.goodsName},#{item.brand},#{item.weight},#{item.origin},#{item.stock},#{item.min},#{item.max},0,now())
		</foreach>
	</insert>
	
	<resultMap type="com.zm.goods.pojo.OrderBussinessModel" id="orderBussinessModel">
		<id column="id" property="id" jdbcType="INTEGER" />
		<result column="item_id" property="itemId" jdbcType="VARCHAR" />
		<result column="supplier_id" property="supplierId" jdbcType="INTEGER" />
		<result column="item_code" property="itemCode" jdbcType="VARCHAR" />
		<result column="sku" property="sku" jdbcType="VARCHAR" />
	</resultMap>
	<select id="checkStock" parameterType="Object" resultMap="orderBussinessModel">
		select i.id, i.item_id,i.sku,i.item_code,i.supplier_id from kj_goods_item i 
		where i.supplier_id != 1 and i.status = 2
	</select>
	
	<select id="checkStockByItemIds" parameterType="Object" resultMap="orderBussinessModel">
		select i.id, i.item_id,i.sku,i.item_code,i.supplier_id 
		from kj_goods_item i where i.item_id in
		<foreach collection="list" item="item" open="(" close=")" separator=",">
			#{item}
		</foreach>
	</select>
	
	<select id="listSkuAndConversionByItemId" parameterType="Object" resultMap="convert">
		select gi.item_id, gi.sku,gtp.conversion,gtp.carton from kj_goods_item gi 
		left join kj_goods_specs_tradepattern gtp on gi.specs_tp_id = gtp.specs_tp_id 
		where gi.item_id in
		<foreach collection="list" item="item" open="(" close=")"
			separator=",">
			#{item}
		</foreach>
	</select>
	
	<select id="countGoodsBySupplierIdAndItemId" parameterType="Object" resultType="java.lang.Integer">
		select count(*) from kj_goods_item 
		where supplier_id = #{supplierId} and item_id in
		<foreach collection="list" item="item" open="(" close=")" separator=",">
			#{item}
		</foreach> 
	</select>
	
	<select id="getOrderGoodsType" parameterType="Object" resultType="java.lang.Integer">
		select distinct g.type from kj_goods g 
		left join kj_goods_specs_tradepattern gtp on g.goods_id = gtp.goods_id
		left join kj_goods_item gi on gtp.specs_tp_id = gi.specs_tp_id
		where gi.supplier_id = #{supplierId} and gi.item_id in 
		<foreach collection="list" item="item" open="(" close=")" separator=",">
			#{item}
		</foreach> 
	</select>
	
	<select id="listGoodsByGoodsIds" parameterType="Object" resultMap="goodsItem">
		select id,goods_id,goods_name, type, access_path, origin from kj_goods where goods_id in
		<foreach collection="list" item="item" open="(" close=")" separator=",">
			#{item}
		</foreach>
	</select>
	
	<select id="getGoodsTypeByGoodsId" parameterType="Object" resultType="java.lang.Integer">
		select type from kj_goods where goods_id = #{goodsId}
	</select>
	
	<select id="getGoodsTypeBySpecsTpIds" parameterType="Object" resultType="java.lang.Integer">
		select g.type from kj_goods_specs_tradepattern gtp left join kj_goods g on gtp.goods_id = g.goods_id 
		where gtp.specs_tp_id in 
		<foreach collection="list" item="item" open="(" close=")" separator=",">
			#{item}
		</foreach>
		group by g.type
	</select>
	
</mapper>